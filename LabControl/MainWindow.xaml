<Window x:Class="LabControl.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:LabControl.ViewModels" xmlns:cmd="http://www.galasoft.ch/mvvmlight"
        mc:Ignorable="d"
        WindowStyle="None"
        MouseLeftButtonDown="WindowMouseLeftButtonDown"
        WindowState="{Binding CurWindowState, Mode=TwoWay}"
        ResizeMode="CanResizeWithGrip"
        Style="{DynamicResource MyWindowStyle}"
        AllowsTransparency="True"
        Title="{Binding WindowTitle}" 
        Height="{Binding WindowHeight, Mode=TwoWay}" 
        Width="{Binding WindowWidth, Mode=TwoWay}"
        >

    <Window.DataContext>
        <local:MainModel/>
    </Window.DataContext>

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="./ResDict.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Window.InputBindings>
        <KeyBinding Modifiers="Control" Key="Q" Command="{Binding QuitCommand}"/>
        <KeyBinding Modifiers="Control" Key="X" Command="{Binding MaximizedCommand}"/>
        <KeyBinding Modifiers="Control" Key="D" Command="{Binding MinimizedCommand}"/>
        <KeyBinding Modifiers="Alt" Key="N" Command="{Binding StandardSizeCommand}"/>
    </Window.InputBindings>

    <x:Code>
        <![CDATA[            
        private void WindowMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
        {
            DragMove();
        }
    ]]>
    </x:Code>

    <DockPanel Margin="5">
        <DockPanel DockPanel.Dock="Top" Height="35">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="35"/>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="35"/>
                    <ColumnDefinition Width="35"/>
                    <ColumnDefinition Width="35"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="{Binding WindowTitle}" 
                           Grid.Column="1"
                           Height="35"
                           FontSize="24"
                           VerticalAlignment="Center"
                           Margin="6,0"/>
                <Button Grid.Column="2"
                        Style="{StaticResource TransparentButton}"
                        Command="{Binding MinimizedCommand}">
                    <Viewbox Margin="3">
                        <Path Stroke="SandyBrown" 
                              StrokeThickness="3"
                              Fill="Transparent"
                              Data="M 0,35 H 35"/>
                    </Viewbox>
                </Button>

                <Button Grid.Column="3"
                        Style="{StaticResource TransparentButton}"
                        Command="{Binding MaximizedCommand}">
                    <Viewbox Margin="3">
                        <Path Stroke="SandyBrown" 
                              StrokeThickness="3"
                              Fill="Transparent"
                              Data="M 0,0 H 35 V 35 H 0 Z"/>
                    </Viewbox>
                </Button>
                <Button Grid.Column="4"
                        Style="{StaticResource TransparentButton}"
                        Command="{Binding QuitCommand}">
                    <Viewbox Margin="3">
                        <Path Stroke="SandyBrown" 
                              StrokeThickness="2    "
                              Fill="Transparent"
                              Data="M 0,0 L 35,35 M 0,35 L 35,0"/>
                    </Viewbox>
                </Button>
            </Grid>
        </DockPanel>

        <DockPanel DockPanel.Dock="Top" Height="32" HorizontalAlignment="Center" VerticalAlignment="Center">
            <Button Style="{StaticResource TransparentButton}" Margin="5,0" Command="{Binding StartPumpCommand}">
                <Viewbox Width="30" Height="30" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <ContentControl HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Grid >
                            <Path Data="m 5710,11643 c -528,-36 -961,-120 -1450,-283 -687,-228 -1338,-595 -1890,-1066 -156,-133 -503,-481 -632,-634 C 918,8686 451,7487 401,6228 343,4755 849,3341 1830,2235 1965,2083 2260,1796 2409,1671 3288,937 4324,501 5490,374 c 199,-21 701,-30 920,-15 1664,113 3178,935 4171,2266 618,829 1000,1834 1093,2875 75,836 -38,1683 -329,2464 -779,2092 -2679,3513 -4910,3676 -125,9 -610,11 -725,3 z m 763,-488 c 1254,-111 2393,-647 3262,-1536 410,-420 709,-843 961,-1364 546,-1127 666,-2364 348,-3575 -169,-646 -494,-1307 -894,-1825 C 9659,2220 9036,1710 8325,1360 7895,1149 7426,994 6965,911 6594,844 6350,826 5945,833 c -310,5 -449,18 -725,62 -1662,271 -3082,1326 -3820,2840 -644,1322 -699,2808 -153,4185 525,1326 1594,2381 2941,2904 451,176 922,286 1417,331 199,18 663,18 868,0 z" Fill="#ff7f2a" Opacity="1"/>
                            <Path Data="m 5500,10283 c -582,-55 -1011,-230 -1347,-547 -259,-244 -427,-545 -488,-871 -21,-111 -16,-369 10,-485 113,-507 506,-1054 1138,-1584 63,-53 117,-96 119,-96 3,0 34,39 70,88 312,417 853,609 1346,477 192,-51 353,-132 487,-242 36,-29 66,-53 69,-53 2,0 12,22 21,49 50,150 252,367 535,573 156,113 300,198 540,317 118,59 257,135 308,170 119,82 221,190 269,288 32,65 37,86 41,162 5,107 -10,165 -78,300 -104,208 -250,403 -444,596 -489,485 -1156,772 -1975,849 -146,14 -515,20 -621,9 z" Fill="#ff7f2a" Opacity="1" />
                            <Path Data="m 5885,7079 c -230,-25 -453,-134 -620,-303 -137,-138 -225,-295 -276,-491 -20,-77 -23,-113 -23,-250 1,-139 4,-173 27,-256 113,-427 460,-726 902,-779 222,-26 464,29 665,151 115,71 278,235 341,344 112,193 153,360 146,580 -5,175 -28,270 -102,420 -64,133 -126,217 -233,316 -218,202 -525,302 -827,268 z m 220,-644 c 160,-42 274,-166 305,-332 41,-227 -139,-452 -373,-470 -189,-14 -370,112 -423,295 -26,88 -16,204 25,286 88,180 278,269 466,221 z" Fill="#ff7f2a" Opacity="1" />
                            <Path Data="m 2720,7025 c -159,-45 -262,-161 -414,-466 -175,-351 -259,-729 -259,-1159 1,-523 122,-1006 388,-1545 174,-352 333,-582 560,-811 198,-199 346,-307 570,-415 144,-70 293,-120 447,-151 150,-30 454,-32 593,-5 203,40 342,96 493,197 456,306 801,998 956,1918 l 23,137 -101,7 c -249,16 -459,85 -655,215 -95,64 -240,197 -307,285 -194,251 -295,594 -264,898 6,60 13,116 16,123 4,11 -15,15 -84,20 -215,16 -476,99 -773,247 -155,78 -253,136 -445,266 -258,174 -419,242 -594,250 -66,3 -112,-1 -150,-11 z" Fill="#ff7f2a" Opacity="1"/>
                            <Path Data="m 8490,6983 c -301,-23 -710,-114 -1050,-232 -204,-70 -282,-103 -276,-115 99,-224 118,-283 141,-436 73,-471 -145,-965 -544,-1239 -84,-57 -212,-125 -282,-150 l -31,-11 31,-35 c 174,-199 273,-802 227,-1390 -28,-359 6,-571 118,-722 112,-152 234,-190 580,-180 886,25 1722,536 2328,1422 347,508 528,1019 528,1495 0,422 -145,829 -404,1132 -229,268 -538,417 -950,457 -102,10 -312,12 -416,4 z" Fill="#ff7f2a" Opacity="1" />
                        </Grid>
                    </ContentControl>
                </Viewbox>
            </Button>
            <Button Style="{StaticResource TransparentButton}" Margin="5,0">
                <Viewbox Width="30" Height="30" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <ContentControl HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Grid>
                            <Path Data="M2468 4890 c-78 -12 -200 -62 -278 -112 -83 -53 -240 -211 -306 -308 -91 -133 -1536 -2671 -1575 -2766 -65 -160 -84 -250 -83 -409 0 -126 3 -148 28 -220 32 -94 59 -143 118 -213 114 -136 293 -228 520 -267 80 -14 278 -16 1678 -16 1398 0 1598 2 1678 16 334 58 554 223 639 479 23 71 27 98 27 216 1 98 -4 157 -17 215 -25 108 -86 262 -145 365 -225 394 -1436 2493 -1476 2558 -139 225 -346 396 -541 447 -76 19 -195 26 -267 15z m243 -219 c173 -65 344 -243 497 -516 95 -170 1159 -2019 1254 -2179 157 -266 230 -441 251 -607 21 -167 -19 -296 -122 -399 -67 -67 -128 -102 -241 -140 -181 -61 -154 -60 -1771 -60 -1013 0 -1502 4 -1564 11 -353 43 -552 194 -588 445 -26 179 54 427 233 724 62 102 1145 1996 1230 2151 161 291 339 488 507 560 26 11 63 24 83 29 54 14 168 4 231 -19z" Fill="#ff7f2a" Opacity="1"/>
                            <Path Data="M2476 4505 c-105 -37 -221 -150 -337 -330 -70 -110 -839 -1453 -839 -1467 0 -5 140 -8 310 -8 171 0 310 3 310 8 0 4 -62 42 -138 85 -75 43 -143 81 -151 86 -11 7 -5 24 28 85 24 42 46 74 49 72 82 -50 496 -286 501 -286 4 0 17 10 29 23 l21 22 -145 250 c-79 137 -144 252 -144 256 0 3 10 11 23 17 12 6 45 24 73 41 l51 30 137 -239 c76 -131 143 -245 149 -253 8 -11 21 -14 40 -10 l27 5 0 299 0 299 90 0 90 0 0 -299 0 -299 31 -7 c17 -4 32 -5 34 -3 2 2 52 86 110 188 59 102 125 215 146 252 l39 67 73 -42 c39 -24 71 -47 70 -52 -2 -6 -66 -119 -143 -252 -77 -133 -140 -249 -140 -256 0 -8 8 -21 18 -30 17 -15 34 -7 277 133 l259 149 41 -72 c23 -40 40 -75 38 -79 -2 -3 -114 -70 -251 -148 -136 -79 -249 -144 -250 -146 -2 -1 -1 -16 3 -33 l7 -31 299 0 299 0 0 -90 0 -90 -300 0 -300 0 -6 -24 c-3 -14 -3 -29 0 -34 3 -5 118 -73 255 -152 l250 -144 -31 -56 c-58 -106 -24 -112 -314 54 -246 142 -257 147 -275 130 -10 -9 -19 -23 -19 -29 0 -10 54 -106 266 -471 l24 -42 -69 -41 c-38 -23 -73 -41 -78 -41 -4 0 -73 113 -152 250 -145 252 -152 261 -195 244 -14 -5 -16 -41 -16 -300 l0 -294 -90 0 -90 0 0 294 0 294 -27 6 c-16 5 -31 2 -38 -6 -7 -7 -72 -116 -145 -243 -72 -126 -135 -234 -140 -239 -8 -8 -134 56 -145 74 -3 5 60 122 141 261 l146 252 -24 23 -23 24 -245 -141 c-134 -78 -250 -143 -256 -146 -10 -4 -94 120 -94 139 0 4 65 44 145 89 80 46 145 87 145 91 0 4 -206 8 -458 8 l-458 0 -44 -77 c-24 -43 -78 -136 -121 -208 -101 -172 -153 -276 -191 -388 -28 -81 -32 -105 -33 -202 0 -95 3 -116 22 -151 54 -101 171 -161 376 -194 98 -15 3032 -15 3142 0 228 33 371 126 391 257 11 74 -2 192 -31 278 -33 97 -111 256 -192 390 -59 98 -1145 1983 -1255 2180 -168 298 -337 456 -488 455 -30 -1 -73 -7 -94 -15z" Fill="#ff7f2a" Opacity="1"/>
                            <Path Data="M2503 2720 c-88 -18 -162 -77 -208 -163 l-20 -38 -540 2 -540 2 -47 -82 c-27 -46 -48 -85 -48 -87 0 -2 267 -4 593 -4 l592 0 30 -51 c58 -98 146 -144 263 -137 78 5 132 28 182 78 59 59 75 102 75 205 0 80 -3 95 -27 136 -63 107 -187 163 -305 139z" Fill="#ff7f2a" Opacity="1"/>
                        </Grid>
                    </ContentControl>
                </Viewbox>
            </Button>
            <Button Style="{StaticResource TransparentButton}" Margin="5,0">
                <Viewbox Width="30" Height="30" >
                    <ContentControl>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="7*"/>
                                <RowDefinition Height="11*"/>
                            </Grid.RowDefinitions>
                            <Path Fill="#ff7f2a" Grid.RowSpan="2">
                                <Path.Data>
                                    <GeometryGroup>
                                        <EllipseGeometry RadiusX="2" RadiusY="2" Center="17,10"  />
                                        <EllipseGeometry RadiusX="2" RadiusY="2" Center="21,13"/>
                                        <EllipseGeometry RadiusX="2" RadiusY="2" Center="21,7"/>
                                        <EllipseGeometry RadiusX="2" RadiusY="2" Center="25,4"/>
                                        <EllipseGeometry RadiusX="2" RadiusY="2" Center="25,10"/>
                                        <EllipseGeometry RadiusX="2" RadiusY="2" Center="25,16"/>
                                    </GeometryGroup>
                                </Path.Data>
                            </Path>
                            <Path Grid.Row="0" Data="M1,3L10,3 14,8 14,12 10,16 1,16z" Stroke="#ff7f2a" StrokeThickness="2" Grid.RowSpan="2"/>
                        </Grid>
                    </ContentControl>
                </Viewbox>
            </Button>
        </DockPanel>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="8*"/>
                <RowDefinition Height="5"/>
                <RowDefinition Height="3*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="50*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="120*"/>
            </Grid.ColumnDefinitions>
            <TabControl 
                Grid.Column="0" 
                Grid.Row="0" 
                TabStripPlacement="Left" 
                Margin="4"  
                Background="Transparent"
                FontFamily="Tahoma" 
                FontSize="16" >
                <!-- Pump && confocal controls-->
                <TabItem VerticalAlignment="Center" 
                         Style="{DynamicResource TabItemStyle}"
                         HorizontalAlignment="Center" >
                    <TabItem.Header>
                        <Viewbox Width="50" Height="50">
                            <ContentControl Content="{StaticResource PumpIcon}" Margin="5"/>
                        </Viewbox>
                    </TabItem.Header>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock TextAlignment="Center" 
                                   Foreground="SandyBrown" 
                                   Text="{Binding LabelPumpOperation}"/>
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                          Width="40" Height="20"  
                                          Margin="1,6,1,6"
                                              IsChecked="{Binding IsPumpPortsConnect}"
                                          />
                                <TextBlock Padding="15,5" 
                                       Foreground="SandyBrown"
                                       Text="{Binding LabelPortConnection}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                      Width="40" Height="20"  
                                      Margin="1,6,1,6"
                                      IsChecked="{Binding IsTwoPump}"/>
                                <TextBlock Padding="15,5" 
                                       Foreground="SandyBrown" 
                                       Text="{Binding LabelPumpCount}"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                              Width="40" Height="20"  
                                              Margin="1,6,1,6"
                                              IsChecked="{Binding IsPumpsActive}" />
                                <TextBlock Padding="15,5" 
                                       Foreground="SandyBrown"
                                       Text="{Binding LabelPumpActive}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                              Width="40" Height="20"  
                                              Margin="1,6,1,6"
                                              IsChecked="{Binding IsConfocalActive}" />
                                <TextBlock Padding="15,5" 
                                       Foreground="SandyBrown"
                                       Text="{Binding LabelConfocalActive}" />
                            </StackPanel>

                            <Grid Margin="3">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="28"/>
                                    <RowDefinition Height="28"/>

                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="5*"/>
                                    <ColumnDefinition Width="2*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0"
                                       VerticalAlignment="Center"
                                       Foreground="SandyBrown" 
                                       Text="{Binding LabelConfocalData}"/>
                                <Border Grid.Row="0" Grid.Column="1"
                                    Margin="1"
                                    BorderBrush="Aquamarine"
                                    CornerRadius="5" BorderThickness="1">
                                    <TextBlock Text="{Binding ConfocalLevel}"
                                           Style="{StaticResource PartTransparent}"
                                           HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Row="1" Grid.Column="0"
                                       Text="{Binding LabelConfocalSetter}"
                                       VerticalAlignment="Center"
                                       Foreground="SandyBrown"
                                />
                                <TextBox Grid.Row="1" Grid.Column="1"
                                         TextAlignment="Center"
                                     Text="{Binding ConfocalLevelSetter}"
                                     Style="{StaticResource PartTransparent}"
                                     Template="{StaticResource TextBoxBaseControlTemplate}"/>
                            </Grid>

                            <Expander Padding="5"
                                  Header="{Binding LabelSettings}"
                                  Foreground="SandyBrown">
                                <StackPanel Margin="15,0,0,0">
                                    <Border Padding="2"
                                            BorderBrush="Aquamarine"
                                            CornerRadius="5" BorderThickness="1">
                                        <StackPanel>
                                            <TextBlock HorizontalAlignment="Center" 
                                                       Text="{Binding LabelPump}"
                                                   Margin="0,5"/>
                                            <DockPanel HorizontalAlignment="Stretch">
                                                <TextBlock 
                                               Foreground="SandyBrown"
                                               VerticalAlignment="Center"
                                                       Padding="0,0,15,0"
                                               Text="{Binding LabelInputPumpPort}"
                                               />
                                                <ComboBox 
                                              ItemsSource="{Binding IncomingPumpPortCollection}"
                                              SelectedItem="{Binding IncomingPumpPortSelected}"
                                              Margin="1"/>
                                            </DockPanel>
                                            <DockPanel>
                                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                                              Width="40" Height="20"  
                                                              IsChecked="{Binding IsRevereFirstPump}"
                                                              Margin="1,6,1,6"/>
                                                <TextBlock Padding="15,0,0,0" 
                                                       VerticalAlignment="Center"
                                                        Foreground="SandyBrown"
                                                        Text="{Binding LabelReverse}" />
                                            </DockPanel>
                                        </StackPanel>
                                    </Border>
                                    <Border Padding="2"
                                            BorderBrush="Aquamarine"
                                            Visibility="{Binding SecondPumpPanelVisibility}"
                                            CornerRadius="5" BorderThickness="1">
                                        <StackPanel>
                                            <TextBlock HorizontalAlignment="Center" 
                                                       Text="{Binding LabelPumpOut}"
                                                   Margin="0,5"/>
                                            <DockPanel HorizontalAlignment="Stretch">
                                                <TextBlock
                                                    Foreground="SandyBrown"
                                                    Padding="0,0,15,0"
                                                    Text="{Binding LabelOutputPumpPort}"
                                                />
                                                <ComboBox
                                                    ItemsSource="{Binding OutcomingPumpPortCollection}"
                                                    SelectedItem="{Binding OutloginPumpPortSelected}"
                                                    Margin="1"/>
                                            </DockPanel>
                                            <DockPanel>
                                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                                              Width="40" Height="20"
                                                              IsChecked="{Binding IsRevereSecondPump}"
                                                              Margin="1,6,1,6"/>
                                                <TextBlock Padding="15,0,0,0" 
                                                        VerticalAlignment="Center"
                                                        Foreground="SandyBrown"
                                                        Text="{Binding LabelReverse}" />
                                            </DockPanel>
                                        </StackPanel>
                                    </Border>

                                </StackPanel>
                            </Expander>
                            <Expander
                                Padding="5"
                                Foreground="SandyBrown"
                                Header="{Binding LabelMonitoring}">
                                <StackPanel x:Name="ConfocalViewBox"
                                            Orientation="Vertical">
                                    <Border
                                    Margin="1"
                                    BorderBrush="Aquamarine"
                                    CornerRadius="5" BorderThickness="1">
                                        <Viewbox 
                                            Height="100">
                                            <Border Margin="2"
                                                    BorderBrush="Bisque"
                                                    CornerRadius="7"
                                                    BorderThickness="2">
                                                <Canvas  
                                                    ClipToBounds="True"
                                                    Width="{Binding ElementName=ConfocalViewBox, Path=ActualWidth}" 
                                                    Height="100"
                                                >
                                                    <Polyline Stroke="#48F" StrokeThickness="1"
                                                          Points="{Binding ConfocalLog, Converter={StaticResource PointConverter}}"
                                                          Canvas.Top="50"/>
                                                </Canvas>
                                            </Border>
                                        </Viewbox>
                                    </Border>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="3*"/>
                                            <ColumnDefinition Width="3*"/>
                                            <ColumnDefinition Width="3*"/>
                                            <ColumnDefinition Width="3*"/>
                                        </Grid.ColumnDefinitions>
                                        <Border Grid.Row="0" Grid.Column="0"
                                                Margin="1"
                                                BorderBrush="Aquamarine"
                                                CornerRadius="5" BorderThickness="1">
                                            <TextBlock Text="{Binding IncomingPumpSpeed}"
                                                Style="{StaticResource PartTransparent}"
                                                HorizontalAlignment="Center"/>
                                        </Border>
                                        <Border Grid.Row="0" Grid.Column="3"
                                                Margin="1"
                                                BorderBrush="Aquamarine"
                                                CornerRadius="5" BorderThickness="1">
                                            <TextBlock Text="{Binding OutcomingPumpSpeed}"
                                                Style="{StaticResource PartTransparent}"
                                                HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                </StackPanel>
                            </Expander>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                <!-- Lasers controls -->
                <TabItem VerticalAlignment="Center" 
                         Style="{DynamicResource TabItemStyle}"
                         HorizontalAlignment="Center" >
                    <TabItem.Header>
                        <Viewbox Width="50" Height="50">
                            <ContentControl Content="{StaticResource LaserIcon}" Margin="5"/>
                        </Viewbox>
                    </TabItem.Header>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock 
                                TextAlignment="Center" 
                                Foreground="SandyBrown" 
                                Text="{Binding LaserOperationTitle}" />
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                          Width="40" Height="20"  
                                          Margin="1,6,1,6"
                                              IsChecked="{Binding IsLaserPortConnected}"
                                          />
                                <TextBlock Padding="15,5" 
                                       Foreground="SandyBrown"
                                       Text="{Binding LabelPortConnection}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                          Width="40" Height="20"  
                                          Margin="1,6,1,6"
                                              IsChecked="{Binding IsLaserEmit}"
                                          />
                                <TextBlock Padding="15,5" 
                                       Foreground="SandyBrown"
                                       Text="{Binding LabelEmitLaser}" />
                            </StackPanel>
                            <Grid Margin="3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="4*"/>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="35"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="28"/>
                                    <RowDefinition Height="28"/>
                                    <RowDefinition Height="28"/>
                                    <RowDefinition Height="28"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0"
                                           VerticalAlignment="Center"
                                           Foreground="SandyBrown"
                                           Text ="{Binding LabelCurrentPower}" />
                                <Border Grid.Row="0" Grid.Column="1"
                                    Margin="1"
                                    BorderBrush="Aquamarine"
                                    CornerRadius="5" BorderThickness="1">
                                    <TextBlock Text="{Binding CurrentLaserPower}"
                                           Style="{StaticResource PartTransparent}"
                                           HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Row="1" Grid.Column="0"
                                           VerticalAlignment="Center"
                                           Foreground="SandyBrown"
                                           Text ="{Binding LabelSetterPower}" />
                                <TextBox Grid.Row="1" Grid.Column="1"
                                     TextAlignment="Center"
                                     Text="{Binding LaserPowerSetter}"
                                     Style="{StaticResource PartTransparent}"
                                     Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                <Button 
                                    Grid.Row="1" Grid.Column="2"
                                    Command="{Binding SetLaserPwrCommand}"
                                    Style="{StaticResource TransparentButton}">
                                    <Viewbox>
                                        <Grid>
                                            <Path  Stroke="SandyBrown" StrokeThickness="3">
                                                <Path.Data>
                                                    <EllipseGeometry RadiusX="11" RadiusY="11" Center="12,12" />
                                                </Path.Data>
                                            </Path>
                                            <Path Data="M9,6L9,19 18,13z" Stroke="SandyBrown" />
                                        </Grid>
                                    </Viewbox>
                                </Button>
                                <TextBlock Grid.Row="2" Grid.Column="0"
                                           VerticalAlignment="Center" 
                                           Foreground="SandyBrown"
                                           Text="{Binding LaserPowerHistory}"/>
                                <ComboBox Grid.Row="2" Grid.Column="1"
                                          Grid.ColumnSpan="2"
                                              ItemsSource="{Binding LaserHistoryCollection}"
                                              SelectedItem="{Binding LaserPowerHistorySelectedItem}"
                                              Margin="0,1"/>
                                <TextBlock Grid.Row="3" Grid.Column="0"
                                           VerticalAlignment="Center" 
                                           Foreground="SandyBrown"
                                           Text="{Binding LabelCurrentTemperature}"/>
                                <Border Grid.Row="3" Grid.Column="1"
                                    Margin="1"
                                    BorderBrush="Aquamarine"
                                    CornerRadius="5" BorderThickness="1">
                                    <TextBlock Text="{Binding CurrentTemperature}"
                                           Style="{StaticResource PartTransparent}"
                                           HorizontalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <Expander Padding="5"
                                  Header="{Binding LabelSettings}"
                                  Foreground="SandyBrown">
                                <Grid Margin="15,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="4*" />
                                        <ColumnDefinition Width="3*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Row="0" Grid.Column="0"
                                               VerticalAlignment="Center"
                                               Foreground="SandyBrown"
                                               Text="{Binding LabelLaserPort}" />
                                    <ComboBox Grid.Row="0" Grid.Column="1"
                                              ItemsSource="{Binding LaserPortCollection}"
                                              SelectedItem="{Binding LaserPortSelected}"
                                              Margin="0,1"/>
                                    <TextBlock Grid.Row="1" Grid.Column="0"
                                               VerticalAlignment="Center"
                                               Foreground="SandyBrown"
                                               Text="{Binding LabelLaserType}" />
                                    <ComboBox Grid.Row="1" Grid.Column="1"
                                              SelectedIndex="{Binding LaserTypeSelectedIndex}"
                                              Margin="0,1">
                                        <TextBlock>Omicron</TextBlock>
                                        <TextBlock>MRL-III-660D</TextBlock>
                                    </ComboBox>
                                </Grid>
                            </Expander>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                <!-- Power supply controls -->
                <TabItem VerticalAlignment="Center" 
                         Style="{DynamicResource TabItemStyle}"
                         HorizontalAlignment="Center" >
                    <TabItem.Header>
                        <Viewbox Width="50" Height="50">
                            <ContentControl Content="{StaticResource PowerIcon}" Margin="5"/>
                        </Viewbox>
                    </TabItem.Header>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock 
                                TextAlignment="Center"
                                Foreground="SandyBrown"
                                Text="{Binding PowerSupplyTitle}" />
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                              Width="40" Height="20"  
                                              Margin="1,6,1,6"
                                              IsChecked="{Binding IsPwrPortConnect}"
                                          />
                                <TextBlock Padding="15,5" 
                                       Foreground="SandyBrown"
                                       Text="{Binding LabelPortConnection}" />
                            </StackPanel>
                            <GroupBox 
                                Margin="3"
                                Foreground="SandyBrown"
                                Header="{Binding LabelChannelsSwitch}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="2*"/>
                                        <ColumnDefinition Width="5*"/>
                                        <ColumnDefinition Width="5*"/>
                                        <ColumnDefinition Width="2*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Row="0" Grid.Column="1"  
                                               Margin="5,5,5,5" 
                                               Text="{Binding LabelUfLed1}"/>
                                    <ToggleButton Grid.Row="0" Grid.Column="0" 
                                                  Style="{StaticResource AnimatedSwitch}" 
                                                  Width="40" Height="20" 
                                                  IsChecked="{Binding PwrSwitchCh0}"
                                                  Margin="2,2,2,2"/>
                                    <TextBlock Grid.Row="0" Grid.Column="2" 
                                               Margin="5,5,5,5" 
                                               Text="{Binding LabelUfLed2}"/>
                                    <ToggleButton Grid.Row="0" Grid.Column="3" 
                                                  Style="{StaticResource AnimatedSwitch}" 
                                                  IsChecked="{Binding PwrSwitchCh1}"
                                                  Width="40" Height="20" />
                                    <TextBlock Grid.Row="1" Grid.Column="1"  
                                               Text="{Binding LabelIkLed1}"
                                               Margin="5,5,5,5"/>
                                    <ToggleButton Grid.Row="1" Grid.Column="0" 
                                                  Width="40" Height="20" 
                                                  IsChecked="{Binding PwrSwitchCh2}"
                                                  Style="{StaticResource AnimatedSwitch}"/>
                                    <TextBlock Grid.Row="1" Grid.Column="2"  
                                               Text="{Binding LabelIkLed2}"
                                               Margin="5,5,5,5"/>
                                    <ToggleButton Grid.Row="1" Grid.Column="3" 
                                                  Width="40" Height="20" 
                                                  IsChecked="{Binding PwrSwitchCh3}"
                                                  Style="{StaticResource AnimatedSwitch}" />
                                    <TextBlock Grid.Row="2" Grid.Column="1" Margin="5,5,5,5"
                                               Text="{Binding LabelMicroCompressor}"/>
                                    <ToggleButton Grid.Row="2" Grid.Column="0" 
                                                  Width="40" Height="20" 
                                                  IsChecked="{Binding PwrSwitchCh4}"
                                                  Style="{StaticResource AnimatedSwitch}" />
                                    <TextBlock Grid.Row="2" Grid.Column="2" 
                                               Text="{Binding LabelGlassHeating}" 
                                               Margin="5,5,5,5"/>
                                    <ToggleButton Grid.Row="2" Grid.Column="3" 
                                                  Width="40" Height="20" 
                                                  IsChecked="{Binding PwrSwitchCh5}"
                                                  Style="{StaticResource AnimatedSwitch}"/>
                                </Grid>
                            </GroupBox>
                            <TabControl
                                TabStripPlacement="Left" 
                                Background="Transparent"
                                Margin="0,0,5,5">
                                <TabItem 
                                    Style="{DynamicResource TabItemStyle}"
                                    VerticalAlignment="Center" 
                                    HorizontalAlignment="Center">
                                    <TabItem.Header>
                                        <TextBlock Text="0" 
                                                   Foreground="SandyBrown"
                                                   Background="Transparent"/>
                                    </TabItem.Header>
                                    <StackPanel>
                                        <Grid Margin="10,10,10,10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="35"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30*"></ColumnDefinition>
                                                <ColumnDefinition Width="18*"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Row="0" Grid.ColumnSpan="2" 
                                                   Foreground="SandyBrown"
                                                   TextAlignment="Center" 
                                                   Text="{Binding LabelChannel0}"/>
                                            <CheckBox Grid.Column="0" Grid.Row="1" 
                                                  Foreground="SandyBrown"
                                                  IsChecked="{Binding PwrSwitchCh0}"
                                                  VerticalAlignment="Center"
                                                  Content="{Binding LabelOn}" />
                                            <TextBlock Grid.Column="0" Grid.Row="2" 
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding LabelPwrChannelMode}" />
                                            <ComboBox  Grid.Column="1" Grid.Row="2" 
                                                   ItemsSource="{Binding PowerSupplyTypes}"
                                                   SelectedIndex="{Binding PwrCh0Mode}"
                                                   Margin="5,5,5,5"/>
                                            <TextBlock Grid.Column="0" Grid.Row="3" 
                                                   Foreground="SandyBrown"
                                                   Text="{Binding LabelPwrChannel0Bias}"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="3" 
                                                 Text="{Binding PwrCh0Bias}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"
                                                 />
                                            <TextBlock Grid.Column="0" Grid.Row="4" 
                                                   Text="{Binding LabelPwrChannelAmplitude}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="4" 
                                                 Text="{Binding PwrCh0Amplitude}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}" />
                                            <TextBlock Grid.Column="0" Grid.Row="5" 
                                                   Foreground="SandyBrown"
                                                   Text="{Binding LabelPwrChannelFreq}"
                                                  VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="5" 
                                                 Text="{Binding PwrCh0Freq}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="6" 
                                                   Text="{Binding LabelPwrChannelDuty}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="6"
                                                 Text="{Binding PwrCh0Duty}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="7" 
                                                   Text="{Binding LabelPwrChannelPhase}"
                                                  Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="7" 
                                                 Text="{Binding PwrCh0Phase}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="8" 
                                                   Text="{Binding LabelPwrMaxVoltage}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="8" 
                                                 Text="{Binding PwrCh0MaxVoltage}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}" />
                                            <TextBlock Grid.Column="0" Grid.Row="9"
                                                   Text="{Binding LabelPwrMaxAmps}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="9" 
                                                 Text="{Binding PwrCh0MaxAmps}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}" />
                                        </Grid>
                                        <StackPanel Orientation="Horizontal"
                                                    HorizontalAlignment="Center">
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelRead}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelWrite}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </TabItem>
                                <TabItem 
                                    Style="{DynamicResource TabItemStyle}"
                                    VerticalAlignment="Center" 
                                    HorizontalAlignment="Center">
                                    <TabItem.Header>
                                        <TextBlock Foreground="SandyBrown" Text="1"/>
                                    </TabItem.Header>
                                    <StackPanel>
                                        <Grid Margin="10,10,10,10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="35"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30*"></ColumnDefinition>
                                                <ColumnDefinition Width="18*"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Row="0" Grid.ColumnSpan="2" 
                                                       Foreground="SandyBrown"
                                                       Text="{Binding LabelChannel1}"
                                                       TextAlignment="Center"/>
                                            <CheckBox Grid.Column="0" Grid.Row="1" 
                                                        IsChecked="{Binding PwrSwitchCh1}"
                                                        VerticalAlignment="Center"
                                                        Foreground="SandyBrown"
                                                        Content="{Binding LabelOn}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="2" 
                                                        Text="{Binding LabelPwrChannelMode}"
                                                        Foreground="SandyBrown"
                                                        VerticalAlignment="Center"/>
                                            <ComboBox Grid.Column="1" Grid.Row="2" 
                                                   ItemsSource="{Binding PowerSupplyTypes}"
                                                   SelectedIndex="{Binding PwrCh1Mode}"
                                                   Margin="5,5,5,5"/>
                                            <TextBlock Grid.Column="0" Grid.Row="3" 
                                                       Text="{Binding LabelPwrChannel1Bias}"
                                                       Foreground="SandyBrown"
                                                        VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="3" 
                                                     Text="{Binding PwrCh1Bias}"
                                                     TextAlignment="Center"
                                                     Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="4" 
                                                       Text="{Binding LabelPwrChannelAmplitude}"
                                                        Foreground="SandyBrown"
                                                        VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="4" 
                                                     Text="{Binding PwrCh1Amplitude}"
                                                     TextAlignment="Center"
                                                     Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="5" 
                                                       Text="{Binding LabelPwrChannelFreq}"
                                                       Foreground="SandyBrown"
                                                        VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="5"
                                                     Text="{Binding PwrCh1Freq}"
                                                     TextAlignment="Center"
                                                     Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="6" 
                                                       Text="{Binding LabelPwrChannelDuty}"
                                                       Foreground="SandyBrown"
                                                        VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="6" 
                                                        Text="{Binding PwrCh1Duty}"
                                                     TextAlignment="Center"
                                                        Style="{StaticResource PartTransparent}"
                                                        Template="{StaticResource TextBoxBaseControlTemplate}" />
                                            <TextBlock Grid.Column="0" Grid.Row="7" 
                                                       Text="{Binding LabelPwrChannelPhase}"
                                                       Foreground="SandyBrown"
                                                        VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="7" 
                                                     Text="{Binding PwrCh1Phase}"
                                                     TextAlignment="Center"
                                                     Style="{StaticResource PartTransparent}"
                                                        Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="8" 
                                                       Text="{Binding LabelPwrMaxVoltage}"
                                                       Foreground="SandyBrown"
                                                        VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="8" 
                                                     Text="{Binding PwrCh1MaxVoltage}"
                                                     TextAlignment="Center"
                                                     Style="{StaticResource PartTransparent}"
                                                        Template="{StaticResource TextBoxBaseControlTemplate}" />
                                            <TextBlock Grid.Column="0" Grid.Row="9" 
                                                       Text="{Binding LabelPwrMaxAmps}"
                                                       Foreground="SandyBrown"
                                                        VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="9" 
                                                     Text="{Binding PwrCh1MaxAmps}"
                                                     TextAlignment="Center"
                                                     Style="{StaticResource PartTransparent}"
                                                        Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                        </Grid>
                                        <StackPanel Orientation="Horizontal"
                                                    HorizontalAlignment="Center">
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelRead}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelWrite}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </TabItem >
                                <TabItem
                                    Style="{DynamicResource TabItemStyle}"
                                    VerticalAlignment="Center" 
                                    HorizontalAlignment="Center">
                                    <TabItem.Header>
                                        <TextBlock Foreground="SandyBrown" Text="2"/>
                                    </TabItem.Header>
                                    <StackPanel>
                                        <Grid Margin="10,10,10,10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="35"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30*"></ColumnDefinition>
                                                <ColumnDefinition Width="18*"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Row="0" Grid.ColumnSpan="2"
                                                   Text="{Binding LabelChannel2}"
                                                   Foreground="SandyBrown"
                                                   TextAlignment="Center" />
                                            <CheckBox Grid.Row="1" Grid.Column="0"
                                                      Foreground="SandyBrown"
                                                  IsChecked="{Binding PwrSwitchCh2}"
                                                  VerticalAlignment="Center"
                                                  Content="{Binding LabelOn}" />
                                            <TextBlock Grid.Column="0" Grid.Row="2" 
                                                   Text="{Binding LabelPwrChannelMode}"
                                                    Foreground="SandyBrown"
                                                   VerticalAlignment="Center" />
                                            <ComboBox  Grid.Column="1" Grid.Row="2" 
                                                   ItemsSource="{Binding PowerSupplyTypes}"
                                                   SelectedIndex="{Binding PwrCh2Mode}"
                                                   Margin="5,5,5,5"/>
                                            <TextBlock Grid.Column="0" Grid.Row="3" 
                                                   Text="{Binding LabelPwrChannel2Bias}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="3" 
                                                 Text="{Binding PwrCh2Bias}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}" />
                                            <TextBlock Grid.Column="0" Grid.Row="4" 
                                                   Text="{Binding LabelPwrChannelAmplitude}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="4" 
                                                 Text="{Binding PwrCh2Amplitude}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="5" 
                                                   Text="{Binding LabelPwrChannelFreq}"
                                                    Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="5"
                                                 Text="{Binding PwrCh2Freq}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="6" 
                                                   Text="{Binding LabelPwrChannelDuty}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="6" 
                                                 Text="{Binding PwrCh2Duty}"
                                                TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="7" 
                                                   Text="{Binding LabelPwrChannelPhase}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="7" 
                                                 Text="{Binding PwrCh2Phase}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="8" 
                                                   Text="{Binding LabelPwrMaxVoltage}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="8"
                                                 Text="{Binding PwrCh2MaxVoltage}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="9" 
                                                   Text="{Binding LabelPwrMaxAmps}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="9" 
                                                 Text="{Binding PwrCh2MaxAmps}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                        </Grid>
                                        <StackPanel Orientation="Horizontal"
                                                    HorizontalAlignment="Center">
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelRead}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelWrite}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </TabItem>
                                <TabItem  Style="{DynamicResource TabItemStyle}"
                                    VerticalAlignment="Center" 
                                    HorizontalAlignment="Center">
                                    <TabItem.Header>
                                        <TextBlock Foreground="SandyBrown" Text="3"/>
                                    </TabItem.Header>
                                    <StackPanel>
                                        <Grid Margin="10,10,10,10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="35"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30*"></ColumnDefinition>
                                                <ColumnDefinition Width="18*"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Row="0" Grid.ColumnSpan="2" 
                                                   Text="{Binding LabelChannel3}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <CheckBox Grid.Row="1" Grid.Column="0"
                                                      Foreground="SandyBrown"
                                                  IsChecked="{Binding PwrSwitchCh3}"
                                                  VerticalAlignment="Center"
                                                  Content="{Binding LabelOn}" />
                                            <TextBlock Grid.Column="0" Grid.Row="2" 
                                                   Text="{Binding LabelPwrChannelMode}"
                                                    Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <ComboBox  Grid.Column="1" Grid.Row="2" 
                                                   ItemsSource="{Binding PowerSupplyTypes}"
                                                   SelectedIndex="{Binding PwrCh3Mode}"
                                                   Margin="5,5,5,5"/>
                                            <TextBlock Grid.Column="0" Grid.Row="3" 
                                                   Text="{Binding LabelPwrChannel3Bias}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="3"
                                                 Text="{Binding PwrCh3Bias}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="4" 
                                                   Text="{Binding LabelPwrChannelAmplitude}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="4" 
                                                 Text="{Binding PwrCh3Amplitude}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="5" 
                                                   Text="{Binding LabelPwrChannelFreq}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="5" 
                                                 Text="{Binding PwrCh3Freq}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="6" 
                                                   Text="{Binding LabelPwrChannelDuty}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="6" 
                                                 Text="{Binding PwrCh3Duty}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="7" 
                                                   Text="{Binding LabelPwrChannelPhase}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="7" 
                                                 Text="{Binding PwrCh3Phase}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="8" 
                                                   Text="{Binding LabelPwrMaxVoltage}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="8"
                                                 Text="{Binding PwrCh3MaxVoltage}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="9" 
                                                   Text="{Binding LabelPwrMaxAmps}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="9" 
                                                 Text="{Binding PwrCh3MaxAmps}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                        </Grid>
                                        <StackPanel Orientation="Horizontal"
                                                    HorizontalAlignment="Center">
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelRead}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelWrite}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </TabItem>
                                <TabItem Style="{DynamicResource TabItemStyle}"
                                    VerticalAlignment="Center" 
                                    HorizontalAlignment="Center">
                                    <TabItem.Header>
                                        <TextBlock Foreground="SandyBrown" Text="4"/>
                                    </TabItem.Header>
                                    <StackPanel>
                                        <Grid Margin="10,10,10,10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="35"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                                <RowDefinition Height="28"></RowDefinition>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30*"></ColumnDefinition>
                                                <ColumnDefinition Width="18*"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Row="0" Grid.ColumnSpan="2" 
                                                   Text="{Binding LabelChannel4}"
                                                   Foreground="SandyBrown"
                                                   TextAlignment="Center"/>
                                            <CheckBox Grid.Row="1" Grid.Column="0"
                                                      Foreground="SandyBrown"
                                                  IsChecked="{Binding PwrSwitchCh4}"
                                                  VerticalAlignment="Center"
                                                  Content="{Binding LabelOn}" />
                                            <TextBlock Grid.Column="0" Grid.Row="2" 
                                                   Text="{Binding LabelPwrChannelMode}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <ComboBox  Grid.Column="1" Grid.Row="2" 
                                                   ItemsSource="{Binding PowerSupplyTypes}"
                                                   SelectedIndex="{Binding PwrCh4Mode}"
                                                   Margin="5,5,5,5"/>
                                            <TextBlock Grid.Column="0" Grid.Row="3" 
                                                   Text="{Binding LabelPwrChannel4Bias}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="3" 
                                                 Text="{Binding PwrCh4Bias}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="4" 
                                                   Text="{Binding LabelPwrChannelAmplitude}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="4" 
                                                 Text="{Binding PwrCh4Amplitude}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="5" 
                                                   Text="{Binding LabelPwrChannelFreq}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="5" 
                                                 Text="{Binding PwrCh4Freq}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="6"
                                                   Text="{Binding LabelPwrChannelDuty}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="6" 
                                                 Text="{Binding PwrCh4Duty}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="7" 
                                                   Text="{Binding LabelPwrChannelPhase}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="7"
                                                 Text="{Binding PwrCh4Phase}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="8"
                                                   Text="{Binding LabelPwrMaxVoltage}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="8" 
                                                 Text="{Binding PwrCh4MaxVoltage}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="9" 
                                                   Text="{Binding LabelPwrMaxAmps}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="9"
                                                 Text="{Binding PwrCh4MaxAmps}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                        </Grid>
                                        <StackPanel Orientation="Horizontal"
                                                    HorizontalAlignment="Center">
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelRead}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelWrite}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </TabItem>
                                <TabItem Style="{DynamicResource TabItemStyle}"
                                    VerticalAlignment="Center" 
                                    HorizontalAlignment="Center">
                                    <TabItem.Header>
                                        <TextBlock Foreground="SandyBrown" Text="5"/>
                                    </TabItem.Header>
                                    <StackPanel>
                                        <Grid Margin="10,10,10,10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="28"/>
                                                <RowDefinition Height="28"/>
                                                <RowDefinition Height="35"/>
                                                <RowDefinition Height="28"/>
                                                <RowDefinition Height="28"/>
                                                <RowDefinition Height="28"/>
                                                <RowDefinition Height="28"/>
                                                <RowDefinition Height="28"/>
                                                <RowDefinition Height="28"/>
                                                <RowDefinition Height="28"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="30*"/>
                                                <ColumnDefinition Width="18*"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Row="0" Grid.ColumnSpan="2" 
                                                   Text="{Binding LabelChannel5}"
                                                   Foreground="SandyBrown"
                                                   TextAlignment="Center"/>
                                            <CheckBox Grid.Row="1" Grid.Column="0"
                                                      Foreground="SandyBrown"
                                                  IsChecked="{Binding PwrSwitchCh5}"
                                                  VerticalAlignment="Center"
                                                  Content="{Binding LabelOn}" />
                                            <TextBlock Grid.Column="0" Grid.Row="2" 
                                                   Text="{Binding LabelPwrChannelMode}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <ComboBox  Grid.Column="1" Grid.Row="2" 
                                                   ItemsSource="{Binding PowerSupplyTypes}"
                                                   SelectedIndex="{Binding PwrCh5Mode}"
                                                   Margin="5,5,5,5"/>
                                            <TextBlock Grid.Column="0" Grid.Row="3" 
                                                   Text="{Binding LabelPwrChannel5Bias}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="3" 
                                                 Text="{Binding PwrCh5Bias}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="4" 
                                                   Text="{Binding LabelPwrChannelAmplitude}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="4" 
                                                 Text="{Binding PwrCh5Amplitude}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="5" 
                                                   Text="{Binding LabelPwrChannelFreq}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="5" 
                                                 Text="{Binding PwrCh5Freq}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="6"
                                                   Text="{Binding LabelPwrChannelDuty}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="6" 
                                                 Text="{Binding PwrCh5Duty}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="7" 
                                                   Text="{Binding LabelPwrChannelPhase}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="7"
                                                 Text="{Binding PwrCh5Phase}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="8"
                                                   Text="{Binding LabelPwrMaxVoltage}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="8" 
                                                 Text="{Binding PwrCh5MaxVoltage}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                            <TextBlock Grid.Column="0" Grid.Row="9" 
                                                   Text="{Binding LabelPwrMaxAmps}"
                                                   Foreground="SandyBrown"
                                                   VerticalAlignment="Center"/>
                                            <TextBox Grid.Column="1" Grid.Row="9"
                                                 Text="{Binding PwrCh5MaxAmps}"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"/>
                                        </Grid>
                                        <StackPanel Orientation="Horizontal"
                                                    HorizontalAlignment="Center">
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelRead}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                            <Border Margin="1"
                                                    BorderBrush="Aquamarine"
                                                    CornerRadius="5" 
                                                    BorderThickness="1">
                                                <Button 
                                                    Style="{StaticResource TransparentButton}"
                                                    Margin="5" 
                                                    Padding="5" 
                                                    Content="{Binding LabelWrite}"
                                                    Foreground="SandyBrown"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </TabItem>
                            </TabControl>
                            <Expander Padding="5"
                                  Header="{Binding LabelSettings}"
                                  Foreground="SandyBrown">
                                <StackPanel>
                                    <TextBlock Text="{Binding LabelPwrPort}"/>
                                    <ComboBox 
                                        ItemsSource="{Binding PwrPortCollection}"
                                        SelectedItem="{Binding PwrPortSelected}"
                                        Margin="0,1"/>
                                </StackPanel>
                            </Expander>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                <!-- Cam controls -->
                <TabItem VerticalAlignment="Center" 
                         Style="{DynamicResource TabItemStyle}"
                         HorizontalAlignment="Center" >
                    <TabItem.Header>
                        <Viewbox Width="50" Height="50">
                            <ContentControl Content="{StaticResource CamIcon}" Margin="5"/>
                        </Viewbox>
                    </TabItem.Header>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                <!-- Piro sensor -->
                <TabItem VerticalAlignment="Center" 
                         Style="{DynamicResource TabItemStyle}"
                         HorizontalAlignment="Center" >
                    <TabItem.Header>
                        <Viewbox Width="50" Height="50">
                            <ContentControl Content="{StaticResource PyroIcon}" Margin="0,0,120,0" />
                        </Viewbox>
                    </TabItem.Header>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock 
                                    TextAlignment="Center" 
                                    Foreground="SandyBrown" 
                                    Text="{Binding PyroOperationTitle}" />
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                              Width="40" Height="20"  
                                              Margin="1,6,1,6"
                                              IsChecked="{Binding IsPyroPortConnected}"
                                />
                                <TextBlock Padding="15,5" 
                                           Foreground="SandyBrown"
                                           Text="{Binding LabelPortConnection}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                              Width="40" Height="20"  
                                              Margin="1,6,1,6"
                                              IsChecked="{Binding IsPyroActive}" />
                                <TextBlock Padding="15,5" 
                                           Foreground="SandyBrown"
                                           Text="{Binding LabelConfocalActive}" />
                            </StackPanel>
                            <Grid Margin="3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="4*"/>
                                    <ColumnDefinition Width="2*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="28"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Grid.Column="0"
                                           VerticalAlignment="Center"
                                           Foreground="SandyBrown" 
                                           Text="{Binding LabelTemperature}"/>
                                <Border Grid.Row="0" Grid.Column="1"
                                        Margin="1"
                                        BorderBrush="Aquamarine"
                                        CornerRadius="5" BorderThickness="1">
                                    <TextBlock Text="{Binding PyroTemperature}"
                                               Style="{StaticResource PartTransparent}"
                                               HorizontalAlignment="Center"/>
                                </Border>
                            </Grid>
                            <Expander Padding="5"
                                  Header="{Binding LabelSettings}"
                                  Foreground="SandyBrown">
                                <Grid Margin="15,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="4*" />
                                        <ColumnDefinition Width="3*" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Row="0" Grid.Column="0"
                                               VerticalAlignment="Center"
                                               Foreground="SandyBrown"
                                               Text="{Binding LabelPyroPort}"/>
                                    <ComboBox Grid.Row="0" Grid.Column="1"
                                              ItemsSource="{Binding PyroPortCollection}"
                                              SelectedItem="{Binding PyroPortSelected}"
                                              Margin="0,1"/>
                                </Grid>
                            </Expander>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                <!-- Dispenser -->
                <TabItem VerticalAlignment="Center" 
                         Style="{DynamicResource TabItemStyle}"
                         HorizontalAlignment="Center" >
                    <TabItem.Header>
                        <Viewbox Width="50" Height="50">
                            <ContentControl Content="{StaticResource DispenserIcon}" Margin="2" />
                        </Viewbox>
                    </TabItem.Header>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock 
                                TextAlignment="Center" 
                                Foreground="SandyBrown" 
                                Text="{Binding DispenserOperationTitle}" />
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                              Width="40" Height="20"  
                                              Margin="1,6,1,6"
                                              IsChecked="{Binding IsDispenserPortConnected}"
                                />
                                <TextBlock Padding="15,5" 
                                           Foreground="SandyBrown"
                                           Text="{Binding LabelPortConnection}" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="5 5 0 0 ">
                                <ToggleButton Style="{StaticResource AnimatedSwitch}" 
                                              Width="40" Height="20"  
                                              Margin="1,6,1,6"
                                              IsChecked="{Binding IsDispenserActive}"
                                />
                                <TextBlock Padding="15,5" 
                                           Foreground="SandyBrown"
                                           Text="{Binding DispenserStartLabel}" />
                            </StackPanel>
                            <Expander Padding="5"
                                  Header="{Binding LabelSettings}"
                                  Foreground="SandyBrown">
                                <StackPanel>
                                    <Grid Margin="15,0,0,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="28"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="6*" />
                                            <ColumnDefinition Width="4*" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0"
                                               VerticalAlignment="Center"
                                               Foreground="SandyBrown"
                                               Text="{Binding LabelPyroPort}"/>
                                        <ComboBox Grid.Row="0" Grid.Column="1"
                                              ItemsSource="{Binding DispenserPortCollection}"
                                              SelectedItem="{Binding DispenserPortSelected}"
                                              Margin="0,1"/>
                                    </Grid>
                                    <Grid Margin="15,0,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="6*" />
                                            <ColumnDefinition Width="4*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="28"/>
                                            <RowDefinition Height="28"/>
                                            <RowDefinition Height="28"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Column="0" Padding="0,0,5,0" 
                                                   VerticalAlignment="Center" 
                                                   Text="{Binding DispenserSignalTypeLabel}"/>
                                        <ComboBox  Grid.Column="1"  
                                                   ItemsSource="{Binding DispenserModeCollection}"
                                                   SelectedIndex="{Binding DispenserSignalType}"
                                                   />
                                        <TextBlock Grid.Column="0" Grid.Row="1" Padding="0,0,5,0" 
                                                   VerticalAlignment="Center" 
                                                   Text="{Binding DispenserCurrentChannelLabel }"/>
                                        <ComboBox Grid.Column="1" Grid.Row="1"
                                                  SelectedIndex="{Binding DispenserChannel}">
                                            <TextBlock>1</TextBlock>
                                            <TextBlock>2</TextBlock>
                                        </ComboBox>
                                        <TextBlock Grid.Column="0" Grid.Row="2" Padding="0,0,5,0" 
                                                   VerticalAlignment="Center" 
                                                   Text="{Binding DispenserFrequencyLabel}"/>
                                        <TextBox Grid.Row="2" Grid.Column="1"
                                                Text="{Binding DispenserFrequency}"
                                               Style="{StaticResource PartTransparent}"
                                               Template="{StaticResource TextBoxBaseControlTemplate}"
                                               TextAlignment="Center"/>
                                    </Grid>
                                    <!--Single Wave-->
                                    <Grid Margin="20,5,1,5" 
                                          Visibility="{Binding DispenserSingleWaveVisible}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="6*" />
                                            <ColumnDefinition Width="4*" />
                                            <ColumnDefinition Width="1*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                                   Grid.ColumnSpan="3" 
                                                   HorizontalAlignment="Center" 
                                                   Text="{Binding DispenserTimeLabel}"/>

                                        <TextBlock Grid.Column="0" Grid.Row="1"
                                                   HorizontalAlignment="Center"
                                                   Padding="5" Text= "{Binding DispenserRiseTimeLabel}"/>
                                        <TextBox Grid.Column="1" Grid.Row="1"
                                                    TextAlignment="Center"
                                                    Style="{StaticResource PartTransparent}"
                                                    Template="{StaticResource TextBoxBaseControlTemplate}"
                                                    Text="{Binding DispenserRiseTime}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="1" Padding="0,3">μs</TextBlock>

                                        <TextBlock Grid.Column="0" Grid.Row="2" Padding="5" 
                                                   HorizontalAlignment="Center"
                                                   Text="{Binding DispenserKeepTimeLabel}"/>
                                        <TextBox Grid.Column="1" Grid.Row="2"
                                                    TextAlignment="Center"
                                                    Style="{StaticResource PartTransparent}"
                                                    Template="{StaticResource TextBoxBaseControlTemplate}"
                                                    Text="{Binding DispenserKeepTime}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="2" Padding="0,3">μs</TextBlock>

                                        <TextBlock Grid.Column="0" Grid.Row="3" Padding="5" 
                                                   HorizontalAlignment="Center"
                                                   Text="{Binding DispenserFallTimeLabel}"/>
                                        <TextBox Grid.Column="1" Grid.Row="3"
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"
                                                 Text="{Binding DispenserFallTime}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="3" Padding="0,3">μs</TextBlock>

                                        <TextBlock Grid.Column="0" Grid.Row="4" Padding="5"
                                                   HorizontalAlignment="Center"
                                                   Text="{Binding DispenserLowTimeLabel}"/>
                                        <TextBox Grid.Column="1" Grid.Row="4" 
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"
                                                 Text="{Binding DispenserLowTime}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="4" Padding="0,3">μs</TextBlock>

                                        <TextBlock Grid.Column="0" Grid.Row="5" Padding="5"
                                                   HorizontalAlignment="Center"
                                                   Text="{Binding DispenserRiseTime2Label}"/>
                                        <TextBox Grid.Column="1" Grid.Row="5" 
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"
                                                 Text="{Binding DispenserRiseTime2}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="5" Padding="0,3">μs</TextBlock>

                                        <TextBlock Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="3" 
                                                   HorizontalAlignment="Center"
                                                   Text="{Binding DispenserVoltageLabel}"/>
                                        <TextBlock Grid.Column="0" Grid.Row="7" Padding="5"
                                                   Text="{Binding DispenserWaitingLabel}"/>
                                        <TextBox Grid.Column="1" Grid.Row="7" 
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"
                                                 Text="{Binding DispenserV0}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="7" Padding="0,3">V</TextBlock>

                                        <TextBlock Grid.Column="0" Grid.Row="8" Padding="5"
                                                   HorizontalAlignment="Center"
                                                   Text="{Binding DispenserMaximumLabel}" />
                                        <TextBox Grid.Column="1" Grid.Row="8" 
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"
                                                 Text="{Binding DispenserV1}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="8" Padding="0,3">V</TextBlock>

                                        <TextBlock Grid.Column="0" Grid.Row="9" Padding="5" 
                                                   HorizontalAlignment="Center"
                                                   Text="{Binding DispenserMinimumLabel}"/>
                                        <TextBox Grid.Column="1" Grid.Row="9" 
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"
                                                 Text="{Binding DispenserV2}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="9" Padding="0,3">V</TextBlock>

                                    </Grid>
                                    <!--Harmonyc Wave-->
                                    <Grid Margin="20,5,1,5" 
                                          Visibility="{Binding DispenserHarmonicallyWaveVisible}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="6*" />
                                            <ColumnDefinition Width="4*" />
                                            <ColumnDefinition Width="1*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Column="0" Grid.Row="0" Padding="5"
                                                   Text="{Binding DispenserAverageLabel}"/>
                                        <TextBox Grid.Column="1" Grid.Row="0" 
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"
                                                 Text="{Binding DispenserHv0}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="0" Padding="0,3">V</TextBlock>

                                        <TextBlock Grid.Column="0" Grid.Row="1" Padding="5" 
                                                   Text="{Binding DispenserPeakLabel}"/>
                                        <TextBox Grid.Column="1" Grid.Row="1" 
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"
                                                 Text="{Binding DispenserHVpeak}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="1" Padding="0,3">V</TextBlock>

                                        <TextBlock Grid.Column="0" Grid.Row="2" Padding="5"
                                                   Text="{Binding DispenserPeriodLabel}"/>
                                        <TextBox Grid.Column="1" Grid.Row="2" 
                                                 TextAlignment="Center"
                                                 Style="{StaticResource PartTransparent}"
                                                 Template="{StaticResource TextBoxBaseControlTemplate}"
                                                 Text="{Binding DispenserHToverall}"/>
                                        <TextBlock Grid.Column="2" Grid.Row="2" Padding="0,3">μs</TextBlock>

                                    </Grid>
                                </StackPanel>
                            </Expander>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
            </TabControl>
            <GridSplitter 
                ResizeDirection="Columns" 
                Grid.Row="0" 
                Grid.Column="1" 
                Height="Auto" 
                Opacity=".3"
                Width="4" 
                HorizontalAlignment="Stretch" 
                VerticalAlignment="Stretch" 
                Margin="0"/>
            <GridSplitter 
                ResizeDirection="Rows" 
                Grid.Row="1" 
                Grid.Column="0" 
                Grid.ColumnSpan="3" 
                Height="4" 
                Width="Auto" 
                Opacity=".3"
                HorizontalAlignment="Stretch" 
                VerticalAlignment="Stretch" 
                Margin="0"/>
            <ListView Grid.Row="2" Grid.ColumnSpan="3" Grid.Column="0"
                      Style="{DynamicResource LogView}"
                      Opacity="0.85"
                      ItemsSource="{Binding LogCollection}">
                <ListView.View>
                    <GridView  ColumnHeaderContainerStyle="{StaticResource GridViewColumnHeaderStyle1}">
                        <GridViewColumn Width="Auto"  Header="#" DisplayMemberBinding="{Binding Current}"/>
                        <GridViewColumn Width="1050" Header="{Binding LogMessageHeader}" DisplayMemberBinding="{Binding Message}"/>
                    </GridView>
                </ListView.View>
            </ListView>
        </Grid>

    </DockPanel>
</Window>
